(this["webpackJsonpreact-whatsappclone"]=this["webpackJsonpreact-whatsappclone"]||[]).push([[0],{34:function(e,t,a){},35:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(16),r=a.n(s),i=a(2),o=a.n(i),u=a(5),d=a(3),l=(a(34),a(27)),h=a.n(l),j=(a(35),a(0)),b=function(e){var t=e.data,a=e.onClick,c=e.active,s=Object(n.useState)(""),r=Object(d.a)(s,2),i=r[0],o=r[1];return Object(n.useEffect)((function(){if(t.last_message_date){var e=new Date(1e3*t.last_message_date.seconds),a=e.getHours(),n=e.getMinutes();a=a<10?"0".concat(a):a,n=n<10?"0".concat(n):n,o("".concat(a,":").concat(n))}}),[t]),Object(j.jsxs)("button",{type:"button",className:"chatListItem",onClick:a,role:"row","aria-selected":c,children:[Object(j.jsx)("img",{className:"chatListItem--avatar",src:t.image,alt:t.title}),Object(j.jsxs)("div",{className:"chatListItem--lines",children:[Object(j.jsxs)("div",{className:"chatListItem--line",children:[Object(j.jsx)("div",{className:"chatListItem--name",children:t.title}),Object(j.jsx)("div",{className:"chatListItem--date",children:i})]}),Object(j.jsx)("div",{className:"chatListItem--line",children:Object(j.jsx)("div",{className:"chatListItem--lastMsg",children:Object(j.jsx)("p",{children:t.last_message})})})]})]})},p=(a(37),function(){return Object(j.jsxs)("div",{className:"chatIntro",children:[Object(j.jsx)("img",{src:"https://web.whatsapp.com/img/intro-connection-hq-light_9466a20e6d2921a21ac7ab82419be157.jpg",alt:"Whatsapp Connected"}),Object(j.jsx)("h1",{children:"Bem-vindo ao Clone do Whatsapp"}),Object(j.jsxs)("h2",{children:["Feito por"," ",Object(j.jsx)("a",{href:"https://github.com/christopherldo/",target:"_blank",rel:"noopener noreferrer",children:"@christopherldo"})]}),Object(j.jsx)("h2",{children:Object(j.jsx)("a",{href:"https://github.com/christopherldo/react-whatsappclone",target:"_blank",rel:"noopener noreferrer",children:"Link para o projeto no Github"})})]})}),f=a(20),m=a.n(f),O=(a(38),a(21)),v=a.n(O),x=a(23),w=a.n(x),g=a(25),N=a.n(g),k=a(24),C=a.n(k),y=(a(39),function(e){var t=e.data,a=e.user,c=Object(n.useState)(""),s=Object(d.a)(c,2),r=s[0],i=s[1];return Object(n.useEffect)((function(){if(t.date){var e=new Date(1e3*t.date.seconds),a=e.getHours(),n=e.getMinutes();a=a<10?"0".concat(a):a,n=n<10?"0".concat(n):n,i("".concat(a,":").concat(n))}}),[t]),Object(j.jsx)("div",{className:"messageLine",style:{justifyContent:a.id===t.author?"flex-end":"flex-start"},children:Object(j.jsxs)("div",{className:"messageItem",style:{backgroundColor:a.id===t.author?"#dcf8c6":"#fff"},children:[Object(j.jsx)("div",{className:"messageText",children:t.body}),Object(j.jsx)("div",{className:"messageDate",children:r})]})})}),_=a(19),S=a(9),W=(a(40),a(41),{apiKey:"AIzaSyANICJaOvCyG9XRaCh0rtK0UIuAhrm8PF4",authDomain:"react-whatsappclone.firebaseapp.com",projectId:"react-whatsappclone",storageBucket:"react-whatsappclone.appspot.com",messagingSenderId:"784776353266",appId:"1:784776353266:web:8a291dbdf5708140b2c76b"}),I=S.a.initializeApp(W),L=I.firestore(),E={fbPopup:function(){return Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new S.a.auth.FacebookAuthProvider,e.abrupt("return",I.auth().signInWithPopup(t));case 2:case"end":return e.stop()}}),e)})))()},googlePopup:function(){return Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new S.a.auth.GoogleAuthProvider,e.abrupt("return",I.auth().signInWithPopup(t));case 2:case"end":return e.stop()}}),e)})))()},addUser:function(e){return Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.collection("users").doc(e.id).set({name:e.name,avatar:e.avatar},{merge:!0});case 2:case"end":return t.stop()}}),t)})))()},getContactList:function(e){return Object(u.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[],t.next=3,L.collection("users").get();case 3:return t.sent.forEach((function(t){var n=t.data();t.id!==e&&a.push({id:t.id,name:n.name,avatar:n.avatar})})),a.sort((function(e,t){return e.name.localeCompare(t.name)})),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})))()},addNewChat:function(e,t,a){return Object(u.a)(o.a.mark((function n(){var c,s,r,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,L.collection("users").doc(e.id).get();case 2:if(!(c=n.sent).exists){n.next=15;break}if(s=c.data(),!(r=s.chats.find((function(e){return e.with===t.id})))){n.next=9;break}return a(r),n.abrupt("return");case 9:return n.next=11,L.collection("chats").add({messages:[],users:[e.id,t.id]});case 11:i=n.sent,L.collection("users").doc(e.id).update({chats:S.a.firestore.FieldValue.arrayUnion({chat_id:i.id,title:t.name,image:t.avatar,with:t.id})}),L.collection("users").doc(t.id).update({chats:S.a.firestore.FieldValue.arrayUnion({chat_id:i.id,title:e.name,image:e.avatar,with:e.id})}),a({chat_id:i.id,title:t.name,image:t.avatar,with:t.id});case 15:case"end":return n.stop()}}),n)})))()},onChatList:function(e,t){return L.collection("users").doc(e).onSnapshot((function(e){if(e.exists){var a=e.data();if(a.chats){var n=Object(_.a)(a.chats);n.sort((function(e,t){return void 0===e.last_message_date?-1:void 0===t.last_message_date||e.last_message_date.seconds<t.last_message_date.seconds?1:-1})),t(n)}}}))},onChatContent:function(e,t,a){return L.collection("chats").doc(e).onSnapshot((function(e){if(e.exists){var n=e.data();n.messages&&(t(n.messages),a(n.users))}}))},sendMessage:function(e,t,a,n,c){return Object(u.a)(o.a.mark((function s(){var r,i,d;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:for(d in L.collection("chats").doc(e.chat_id).update({messages:S.a.firestore.FieldValue.arrayUnion({type:a,author:t,body:n,date:new Date})}),r=function(){var t=Object(u.a)(o.a.mark((function t(a){var s,r,i,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.collection("users").doc(c[a]).get();case 2:if(s=t.sent,!(r=s.data()).chats){t.next=9;break}for(u in i=Object(_.a)(r.chats))i[u].chat_id===e.chat_id&&(i[u].last_message=n,i[u].last_message_date=new Date);return t.next=9,L.collection("users").doc(c[a]).update({chats:i});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i=[],c)d&&r(d);return s.next=6,Promise.all(i);case 6:case"end":return s.stop()}}),s)})))()}},P=function(e){var t,a=e.user,c=e.data,s=window.SpeechRecognition||window.webkitSpeechRecognition;s&&(t=new s);var r=Object(n.useRef)(),i=Object(n.useState)(!1),o=Object(d.a)(i,2),u=o[0],l=o[1],h=Object(n.useState)(""),b=Object(d.a)(h,2),p=b[0],f=b[1],O=Object(n.useState)(!1),x=Object(d.a)(O,2),g=x[0],k=x[1],_=Object(n.useState)(""),S=Object(d.a)(_,2),W=S[0],I=S[1],L=Object(n.useState)([]),P=Object(d.a)(L,2),A=P[0],F=P[1],R=Object(n.useState)([]),U=Object(d.a)(R,2),D=U[0],H=U[1],M=function(){p&&(E.sendMessage(c,a.id,"text",p,D),f(""),l(!1))};Object(n.useEffect)((function(){""===p&&I("Digite uma mensagem")}),[p]),Object(n.useEffect)((function(){return F([]),E.onChatContent(c.chat_id,F,H)}),[c.chat_id]),Object(n.useEffect)((function(){r.current.scrollHeight>r.current.offsetHeight&&(r.current.scrollTop=r.current.scrollHeight-r.current.offsetHeight)}),[A]);return Object(j.jsxs)("div",{className:"chatWindow",children:[Object(j.jsx)("div",{className:"chatWindow--header",children:Object(j.jsxs)("div",{className:"chatWindow--headerinfo",children:[Object(j.jsx)("img",{src:c.image,alt:c.title,className:"chatWindow--avatar"}),Object(j.jsx)("div",{className:"chatWindow--name",children:c.title})]})}),Object(j.jsx)("div",{ref:r,className:"chatWindow--body",children:A.map((function(e,t){return Object(j.jsx)(y,{data:e,user:a},t)}))}),Object(j.jsx)("div",{className:"chatWindow--emojiarea",style:{height:u?"250px":"0px"},children:Object(j.jsx)(m.a,{onEmojiClick:function(e,t){f(p+t.emoji)},disableSearchBar:!0,disableSkinTonePicker:!0})}),Object(j.jsxs)("div",{className:"chatWindow--footer",children:[Object(j.jsxs)("div",{className:"chatWindow--pre",children:[Object(j.jsx)("button",{type:"button",className:"chatWindow--btn",onClick:function(){return l(!1)},style:{width:u?"40px":"0px"},children:Object(j.jsx)(v.a,{})}),Object(j.jsx)("button",{type:"button",className:"chatWindow--btn",onClick:function(){return l(!0)},"aria-hidden":"true",children:Object(j.jsx)(w.a,{style:{color:u?"#009688":"#919191"}})})]}),Object(j.jsx)("div",{className:"chatWindow--inputarea",children:Object(j.jsx)("input",{type:"text",className:"chatWindow--input",placeholder:W,value:p,onChange:function(e){return f(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&M()}})}),Object(j.jsx)("div",{className:"chatWindow--pos",children:p?Object(j.jsx)("button",{type:"button",onClick:M,className:"chatWindow--btn",children:Object(j.jsx)(C.a,{})}):Object(j.jsx)("button",{type:"button",onClick:function(){if(t){if(g)return I("Reconhecendo a voz..."),k(!1),void t.stop();I("Fale agora"),t.onstart=function(){k(!0)},t.onend=function(){k(!1)},t.onresult=function(e){f(e.results[0][0].transcript)},t.start()}},className:"chatWindow--btn",children:Object(j.jsx)(N.a,{style:{color:g?"#126ece":"#919191"}})})})]})]})},A=(a(48),a(26)),F=a.n(A),R=function(e){var t=e.user,a=e.show,c=e.setShow,s=e.setActiveChat,r=Object(n.useState)([]),i=Object(d.a)(r,2),l=i[0],h=i[1],b=function(){var e=Object(u.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,E.getContactList(t.id);case 3:a=e.sent,h(a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(u.a)(o.a.mark((function e(a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.addNewChat(t,a,s);case 2:c(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){b()}),[a]),Object(j.jsxs)("div",{className:"newChat",style:{left:a?0:-415},children:[Object(j.jsxs)("div",{className:"newChat--head",children:[Object(j.jsx)("button",{type:"button",className:"newChat--backbutton",onClick:function(){return c(!1)},children:Object(j.jsx)(F.a,{})}),Object(j.jsx)("div",{className:"newChat-headtitle",children:"Nova Conversa"})]}),Object(j.jsx)("div",{className:"newChat--list",children:l.map((function(e){return Object(j.jsxs)("button",{type:"button",onClick:function(){return p(e)},className:"newChat--item",children:[Object(j.jsx)("img",{className:"newChat--itemavatar",src:e.avatar,alt:e.name}),Object(j.jsx)("div",{className:"newChat--itemname",children:e.name})]},e.id)}))})]})},U=(a(49),function(e){var t=e.onReceive,a=function(){var e=Object(u.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.fbPopup();case 3:(a=e.sent)?t(a.user):alert("Erro desconhecido ou permiss\xe3o negada, tente novamente."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("".concat(e.t0,": ").concat(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(u.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.googlePopup();case 3:(a=e.sent)?t(a.user):alert("Erro desconhecido ou permiss\xe3o negada, tente novamente."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("".concat(e.t0,": ").concat(e.t0.message));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"login",children:[Object(j.jsx)("button",{type:"button",onClick:a,children:"Logar com o Facebook"}),Object(j.jsx)("button",{type:"button",onClick:n,children:"Logar com o Google"})]})}),D=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(null),r=Object(d.a)(s,2),i=r[0],l=r[1],f=Object(n.useState)(null),m=Object(d.a)(f,2),O=m[0],v=m[1],x=Object(n.useState)(!1),w=Object(d.a)(x,2),g=w[0],N=w[1],k=function(){var e=Object(u.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:t.uid,name:t.displayName,avatar:t.photoURL},e.next=3,E.addUser(a);case 3:v(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return O?E.onChatList(O.id,c):null}),[O]),Object(j.jsx)(j.Fragment,{children:O?Object(j.jsxs)("div",{className:"app-window",children:[Object(j.jsxs)("div",{className:"sidebar",children:[Object(j.jsx)(R,{user:O,show:g,setShow:N,chatList:a,setActiveChat:l}),Object(j.jsxs)("header",{children:[Object(j.jsx)("img",{className:"header--avatar",src:O.avatar,alt:"Avatar"}),Object(j.jsx)("div",{className:"header--buttons",children:Object(j.jsx)("button",{type:"button",className:"header--btn",onClick:function(){return N(!0)},children:Object(j.jsx)(h.a,{})})})]}),Object(j.jsx)("div",{className:"chatlist",children:a.map((function(e){return Object(j.jsx)(b,{data:e,onClick:function(){return l(e)},active:(null===i||void 0===i?void 0:i.chat_id)===e.chat_id},e.chat_id)}))})]}),Object(j.jsx)("div",{className:"contentarea",children:i?Object(j.jsx)(P,{user:O,data:i}):Object(j.jsx)(p,{})})]}):Object(j.jsx)(U,{onReceive:k})})};r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(D,{})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.e3287e5e.chunk.js.map